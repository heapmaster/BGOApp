<div class="container">
  <div class="page-header">
    <h1>Current Rankings</h1>
  </div>
  <table class="table">
    <% var count = 0; %>
    <% var offset = 0; %>
    <% var last = 1337; %>
    
    <% _.each(countries, function(country){ %>
    <%   if (country.score < last) { %>
    <%     count = count + offset + 1; %>
    <%     offset = 0; %>
    <%   } else { offset = offset + 1; } %>
    <%   var percent_score = max_score / country.score * 100.0 %>

    <tr>
      <td class="col-md-1" style="text-align:center; vertical-align:middle;">
        <span class="h4"><%= count %></span>
      </td>
      <td class="col-md-1" style="vertical-align:middle;">
        <img src="<%= country.flag %>" class="img-rounded img-responsive" style="padding:10px">
      </td>
      <td class="col-md-2" style="vertical-align:middle;">
        <span class="h4"><%= country.country %></span>
      </td>
      <td class="col-md-7" style="vertical-align:middle;">
      <div class="progress" style="margin-top:20px">
        <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: <%= percent_score %>%;">
          <span class="sr-only">100% Complete</span>
        </div>
      </div>
      </td>
      <td class="col-md-1" style="text-align:center; vertical-align:middle;">
        <span class="h4" style="padding-right:5px;"><%= country.score %></span><span class="glyphicon glyphicon-certificate"></span>
      </td>
    </tr>

    <%   last = country.score; %>
    <% }); %>

  </table>
</div>
